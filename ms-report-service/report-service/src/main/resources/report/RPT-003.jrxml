<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="RPT-003" pageWidth="595" pageHeight="842" whenNoDataType="NoDataSection" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="a268d07c-d9b0-4632-9492-374e649379c4">
	<property name="ireport.zoom" value="1.4641000000000033"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="net.sf.jasperreports.print.keep.full.text" value="true"/>
	<property name="net.sf.jasperreports.export.xls.wrap.text" value="true"/>
	<parameter name="dateFrom" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="dateTo" class="java.util.Date"/>
	<parameter name="dateFromTh" class="java.lang.String"/>
	<parameter name="dateToTh" class="java.lang.String"/>
	<queryString>
		<![CDATA[WITH INV AS (
   SELECT ADMIN_ID, STATUS
   FROM INVITE_DETAIL
   WHERE TO_DATE(CREATE_DATE_TIME,'dd-mm-yyyy') >= $P{dateFrom}
   AND TO_DATE(CREATE_DATE_TIME,'dd-mm-yyyy') <= $P{dateTo}
), BK0 AS (
   SELECT CS.ADMIN_ID,'โอนเงินเเล้ว' DESC,COUNT(1) COUNT_INV
   FROM BOOKING BK
   JOIN CUSTOMER_DETAIL CS
   ON (BK.CUSTOMER_ID = CS.ID
       AND BK.BOOKING_STATUS IN ('PAYMENT_VERIFIED','CONFIRMED')
   )
   WHERE BK.PAYMENT_TIME  >= $P{dateFrom}
   AND BK.PAYMENT_TIME <= $P{dateTo}
   GROUP BY CS.ADMIN_ID
), ALL_DATA AS (
   SELECT ADMIN_ID, 'ยังไม่เปิดดู' DESC, count(1) COUNT_INV FROM INV where STATUS IN ('ACTIVE','EXPIRED') GROUP BY ADMIN_ID
   UNION ALL
   SELECT ADMIN_ID, 'เปิดดูเเล้ว' DESC, count(1) COUNT_INV FROM INV where STATUS IN ('OPEN-ACTIVE','OPENED-EXPIRED') GROUP BY ADMIN_ID
   UNION ALL
   SELECT ADMIN_ID ,'ลงทะเบียนเเล้ว' DESC, count(1) COUNT_INV FROM INV where STATUS = ('COMPLETE') GROUP BY ADMIN_ID
   UNION ALL
   SELECT * FROM BK0
)
SELECT US.USERID,US.FULL_NAME,ALL_DATA.DESC,ALL_DATA.COUNT_INV FROM USER US
LEFT JOIN ALL_DATA
ON (US.USERID = ALL_DATA.ADMIN_ID)
ORDER BY US.USERID,ALL_DATA.DESC]]>
	</queryString>
	<field name="USERID" class="java.lang.Integer"/>
	<field name="FULL_NAME" class="java.lang.String"/>
	<field name="DESC" class="java.lang.String"/>
	<field name="COUNT_INV" class="java.lang.Integer"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="31" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="236" height="25" isPrintWhenDetailOverflows="true" uuid="13c86836-432d-4e9a-a81b-15ac3e1df093"/>
				<box>
					<bottomPen lineWidth="0.0" lineStyle="Dashed"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["รายงานสรุปคำเชิญของแอดมินประจำวันที่"]]></textFieldExpression>
			</textField>
			<textField pattern="dd-MMM-yy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="404" y="0" width="151" height="25" isPrintWhenDetailOverflows="true" uuid="f12bc6e6-c8c6-4aab-8d13-b26e8ce96f31"/>
				<box>
					<bottomPen lineWidth="1.0" lineStyle="Dashed"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{dateToTh}]]></textFieldExpression>
			</textField>
			<textField pattern="dd-MMM-yy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="236" y="0" width="100" height="25" isPrintWhenDetailOverflows="true" uuid="bdc25dcd-3bae-4a52-9c6e-9b3666a94b7c"/>
				<box>
					<bottomPen lineWidth="1.0" lineStyle="Dashed"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{dateFromTh}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="336" y="0" width="68" height="25" isPrintWhenDetailOverflows="true" uuid="f4d31f9f-15a5-4804-9e0b-8029b81916f5"/>
				<box>
					<bottomPen lineWidth="0.0" lineStyle="Dashed"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["ถึงวันที่"]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<columnHeader>
		<band height="32" splitType="Stretch">
			<staticText>
				<reportElement stretchType="RelativeToBandHeight" mode="Opaque" x="0" y="0" width="213" height="32" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#FF9999" uuid="67d653d8-32f6-4a20-b66d-379f7674ddb5"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" isBold="true" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph leftIndent="10"/>
				</textElement>
				<text><![CDATA[Admin]]></text>
			</staticText>
			<staticText>
				<reportElement stretchType="RelativeToBandHeight" mode="Opaque" x="401" y="0" width="154" height="32" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#FF9999" uuid="79c7e569-98d9-4d63-8617-74b239b41c5d"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" isBold="true" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph leftIndent="10"/>
				</textElement>
				<text><![CDATA[จำนวนการเชิญ]]></text>
			</staticText>
			<staticText>
				<reportElement stretchType="RelativeToBandHeight" mode="Opaque" x="213" y="0" width="188" height="32" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#FF9999" uuid="c5e46d91-2dd6-498d-94ef-0005d57105b8"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" isBold="true" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph leftIndent="10"/>
				</textElement>
				<text><![CDATA[สถานะการเชิญ]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="31" splitType="Immediate">
			<printWhenExpression><![CDATA[true]]></printWhenExpression>
			<textField isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="213" height="31" isPrintWhenDetailOverflows="true" uuid="80ffe8e7-7c7b-466c-a5a9-351a53bd8c8c"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FULL_NAME}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="213" y="0" width="188" height="31" isPrintWhenDetailOverflows="true" uuid="89cb0e3c-4f8c-49e7-8341-93d35c85e3ae"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DESC}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="401" y="0" width="154" height="31" isPrintWhenDetailOverflows="true" uuid="42f9ec6c-1c03-4d7e-872a-f3133f45bfdc"/>
				<box rightPadding="3">
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph rightIndent="3" spacingAfter="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{COUNT_INV}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band/>
	</summary>
	<noData>
		<band height="111">
			<staticText>
				<reportElement stretchType="RelativeToBandHeight" mode="Opaque" x="0" y="73" width="555" height="31" isPrintWhenDetailOverflows="true" backcolor="#FFFFFF" uuid="bcf7ce6a-9999-4c1e-a931-f3b9607aa34d"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph leftIndent="10"/>
				</textElement>
				<text><![CDATA[ไม่พบข้อมูล]]></text>
			</staticText>
			<textField pattern="dd-MMM-yy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="236" y="10" width="100" height="25" isPrintWhenDetailOverflows="true" uuid="407284b8-2f97-4d67-8405-8fe9dad3b8a1"/>
				<box>
					<bottomPen lineWidth="1.0" lineStyle="Dashed"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{dateFromTh}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement stretchType="RelativeToBandHeight" mode="Opaque" x="213" y="41" width="188" height="32" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#FF9999" uuid="275e9158-2d45-4935-8b5b-409260400313"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" isBold="true" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph leftIndent="10"/>
				</textElement>
				<text><![CDATA[สถานะการเชิญ]]></text>
			</staticText>
			<textField pattern="dd-MMM-yy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="404" y="10" width="151" height="25" isPrintWhenDetailOverflows="true" uuid="f17904fb-8bae-4b23-9c30-d1f0505ad5ec"/>
				<box>
					<bottomPen lineWidth="1.0" lineStyle="Dashed"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{dateToTh}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="0" y="10" width="236" height="25" isPrintWhenDetailOverflows="true" uuid="e1210245-734c-4d44-8c54-3d8b3ec38f02"/>
				<box>
					<bottomPen lineWidth="0.0" lineStyle="Dashed"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["รายงานสรุปคำเชิญของแอดมินประจำวันที่"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement stretchType="RelativeToBandHeight" mode="Opaque" x="0" y="41" width="213" height="32" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#FF9999" uuid="09352329-2548-45f2-99b2-8118956451b8"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" isBold="true" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph leftIndent="10"/>
				</textElement>
				<text><![CDATA[Admin]]></text>
			</staticText>
			<staticText>
				<reportElement stretchType="RelativeToBandHeight" mode="Opaque" x="401" y="41" width="154" height="32" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#FF9999" uuid="23eb45e9-3e47-4a0b-9696-19dd52d9a045"/>
				<box>
					<pen lineColor="#000000"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="TH Sarabun New" size="12" isBold="true" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					<paragraph leftIndent="10"/>
				</textElement>
				<text><![CDATA[จำนวนการเชิญ]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="336" y="10" width="68" height="25" isPrintWhenDetailOverflows="true" uuid="5ef2ca4b-84d7-49f6-a790-ab23d760fc8e"/>
				<box>
					<bottomPen lineWidth="0.0" lineStyle="Dashed"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font fontName="TH Sarabun New" size="12" pdfFontName="TH Sarabun New" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["ถึงวันที่"]]></textFieldExpression>
			</textField>
		</band>
	</noData>
</jasperReport>
